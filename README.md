# Scalable Pilot, Feedback and Precoding Design for FDD Multi-User MIMO via Deep Learning

The codes are for the paper "Scalable Pilot, Feedback and Precoding Design for FDD Multi-User MIMO via Deep Learning, " 
which has been submitted to ICC2025 for possible publication.

## Requirements
The DL model is implemented in Python and uses the PyTorch library. The following packages are required:
- Python (version: 3.11.8)
- PyTorch (version: 2.2.1)
- Numpy (version: 1.26.4)
- Scipy (version: 1.12.0)

## Directory Structure
The directory structure is as follows:
- `Data`: This directory contains the real-world channel dataset generated by Ray-tracing simulator.
- `Figs`: This directory contains the figures of the simulations.
- `MATLAB_files`: This directory contains the MATLAB scripts for generating the simulation figures.
- `Res`: This directory contains sum-rate results of the baseline and proposed DL models.
- `Saved_model`: This directory contains the trained model that can be directly used for testing.
- `Utils`: This directory contains the implementation of the existing DL model in [1] and the proposed DL model.

## Training Scripts
The following Python scripts are provided for training the DL methods:
- `Train_Baseline_K=6_Varying_SNR.py`: This script trains the baseline DL model for $K=6$ with varying $\text{SNR}$.
- `Train_Baseline_Varying_K_SNR=10dB.py`: This script trains the baseline DL model with varying number of users for $\text{SNR}=10 \text{dB}$.
- `Train_GAT_K=6_Varying_SNR.py`: This script trains the proposed DL model for $K=6$ with varying $\text{SNR}$.

## Testing Scripts
The following Python scripts are provided for testing the DL methods:
- `Test_Baseline_Rate_vs_SNR.py`: This script generates the sum-rate of the baseline DL method for case $K=6$ under varying $\text{SNR}$.
- `Test_Baseline_Rate_vs_K.py`: This script generates the sum-rate the baseline DL method for case $\text{SNR}=10$ dB under varying number of users.
- `Test_GAT_Rate_vs_SNR.py`: This script generates the sum-rate of the proposed DL method for case $K=6$ under varying $\text{SNR}$.
- `Test_GAT_Rate_vs_K.py`: This script generates the sum-rate of the proposed DL method for case $\text{SNR}=10 \text{dB}$ under varying number of users.

## Results
The figures of the simulations are stored in the `Figs` directory, which contains the following figures:
- `Rate_vs_SNR_L=4_B=10_K=6.fig`: The sum-rate vs. $\text{SNR}$ curve for $K=6$ users.
- `Rate_vs_K_L=4_B=10_SNR=10dB.fig`: The sum-rate vs. number of users for $\text{SNR}=10 \text{dB}$.

## Acknowledgement
The implementation of the vector quantization is based in part on the source code provided in [2].

## References
[1] F. Sohrabi, K. M. Attiah, and W. Yu, "Deep learning for distributed channel feedback and multiuser precoding in FDD massive MIMO," _IEEE Trans. Wireless Commun._, vol. 20, no. 7, pp. 4044–4057, Jul. 2021.

[2] H. M. Vali and T. Bäckström, ``Stochastic optimization of vector quantization methods in application to speech and image processing,'' in _Proc. IEEE Int. Conf. Acoust. Speech Signal Process. (ICASSP)_, 2023, pp. 1–5.

## Contact
For any questions or comments, please contact [lin-eee.zhu@connect.polyu.hk](mailto:lin-eee.zhu@connect.polyu.hk)